<!doctype html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>小鹿帮帮~</title>
  <!-- 预加载两种收款码图片，避免切换支付方式时首次出现的加载延迟 -->
  <link rel="preload" as="image" href="微信收款码.png" />
  <link rel="preload" as="image" href="支付宝收款码.png" />
  <style>
    /* 主题变量（会被 JS 动态切换） */
    :root{
      --bg:#f6f7fb;--card:#ffffff;--muted:#6b7280;--accent:#10b981;--border:#e6e9ef;
    }
    /* 基本重置和排版 */
    *{box-sizing:border-box}body{font-family:system-ui,-apple-system,Segoe UI,Roboto,'Helvetica Neue',Arial;margin:0;background:var(--bg);color:#0f172a}
    .wrap{max-width:1280px;margin:28px auto;padding:18px}
    .panel{background:var(--card);border:1px solid var(--border);border-radius:12px;box-shadow:0 6px 18px rgba(12,23,48,0.06);overflow:hidden;position:relative}
    .grid{display:grid;grid-template-columns:360px 1fr;gap:0}
    /* 平板及以下：单列布局（先列表后详情），满足手机端期望：点击后详情在列表下方 */
    @media (max-width:880px){
      .grid{grid-template-columns:1fr}
      .aside{order:1}
      .main{order:2}
    }
    .aside{border-right:1px solid var(--border);padding:18px;height:640px;overflow:auto;position:relative;z-index:30} /* Eliya备注：侧栏整体层级提高，确保展开层在新增按钮之上 */
    .main{padding:20px}
    h1{font-size:22px;margin:0 0 6px}
    p.lead{margin:0 0 12px;color:var(--muted);font-size:13px}
    .top-controls{display:flex;gap:8px;align-items:center;margin-bottom:10px}
    .panel-header{padding:12px;display:flex;justify-content:space-between;align-items:center}
    .top-hint{white-space:nowrap}
    .theme-chooser{display:flex;gap:6px;align-items:center}
    .theme-btn{width:28px;height:20px;border-radius:6px;border:1px solid var(--border);cursor:pointer}
    .search{display:flex;gap:8px;margin-bottom:12px}
    .search input{flex:1;padding:10px;border:1px solid var(--border);border-radius:8px}
    /* 游戏单元：改为块级容器，内部一行用于 handle/card/menu，服务列表保持宽度 100% 在下方显示 */
    .game{border-radius:10px;margin-bottom:8px;background:transparent;position:relative;display:block}
    .game-row{display:flex;align-items:stretch}
    /* 左侧拖拽把手 */
.handle{width:40px;display:flex;align-items:center;justify-content:center;cursor:grab;padding:6px}
    .handle:active{cursor:grabbing}
    .handle .bar{width:16px;height:2px;background:var(--muted);margin:2px 0;border-radius:2px}
    /* 卡片主体 */
    .game-card{flex:1;border-radius:10px;display:flex;align-items:center;justify-content:space-between;padding:12px;border:1px solid var(--border);background:linear-gradient(180deg,#fff,#fff);cursor:default}
    .game-card:hover{box-shadow:0 4px 12px rgba(16,185,129,0.06);border-color:var(--border)}
    /* 游戏品类展开时的强调效果 */
    .game-card.active-cat{transform:scale(0.98);box-shadow:0 8px 24px rgba(2,6,23,0.10);border-color:#8ABBFF;background:linear-gradient(180deg,#f6f9ff,#ffffff)}
    .meta{font-size:18px;color:#0f172a}
    .tag{font-size:13px;color:var(--muted)}
    /* 三点菜单区域（右下） */
    .more-wrap{position:relative;margin-left:8px;display:flex;align-items:center;padding-bottom:0}
    .more-btn{width:34px;height:34px;border-radius:6px;border:1px solid var(--border);background:#fff;display:flex;align-items:center;justify-content:center;cursor:pointer}
    .dot{width:4px;height:4px;background:var(--muted);border-radius:50%;margin:1px 0}
    .menu{position:absolute;right:0;bottom:40px;background:#fff;border:1px solid var(--border);border-radius:8px;box-shadow:0 8px 24px rgba(2,6,23,0.08);overflow:hidden;display:none;z-index:20}
    .menu button{display:block;padding:8px 12px;border:none;background:transparent;width:100%;text-align:left;cursor:pointer}
    .menu button:hover{background:#f6f9ff}
    /* 服务列表：宽度 100%，在卡片下方（默认折叠），只使用 transform/opacity 动画，避免高度动画引发回流 */
.services{padding:0 8px;display:block;width:100%;height:0;overflow:hidden}
.services.open{height:auto;padding:8px}
.anim-content{opacity:0;transform:translateY(-6px);transition:opacity 0.1s ease-out,transform 0.1s ease-out}
.services.open > .anim-content{opacity:1;transform:translateY(0)}
.services.closing > .anim-content{opacity:0;transform:translateY(-6px)}
/* 子集分组（与管理员页保持一致的结构与样式，便于按子集展示服务）*/
.subset{padding:8px;border:1px solid var(--border);border-radius:8px;background:#fff;margin-bottom:8px}
.subset-header{display:flex;align-items:center;justify-content:space-between;cursor:pointer}
.subset-name{font-weight:600}
.subset-services{padding:0 0 0 0;display:block;height:0;overflow:hidden}
.subset-services.open{height:auto;padding:8px 0 0 0}
.subset-services > .anim-content{opacity:0;transform:translateY(-6px);transition:opacity 0.1s ease-out,transform 0.1s ease-out}
.subset-services.open > .anim-content{opacity:1;transform:translateY(0)}
.subset-services.closing > .anim-content{opacity:0;transform:translateY(-6px)}
.subset .toggleIndicator{font-size:18px;color:var(--muted);padding-left:8px}
/* 子集备注样式：灰色、小字号，位于子集名称下方 */
.subset-remark{font-size:12px;color:var(--muted);margin-top:4px}
/* 子集展开时的强调效果（与游戏品类强调一致） */
    .subset.active-subset{transform:scale(0.98);box-shadow:0 8px 24px rgba(2,6,23,0.10);border-color:#8ABBFF;background:linear-gradient(180deg,#f6f9ff,#ffffff)}
    .service{padding:8px;border-radius:8px;border:1px solid var(--border);margin-bottom:8px;cursor:pointer;background:#fff}
    .service:hover{transform:translateY(-2px);box-shadow:0 6px 18px rgba(2,6,23,0.04)}
    /* 手机端展开时的强调效果：类似按钮被按下（轻微缩放 + 高亮边框/阴影） */
    .service.active-svc{transform:scale(0.98);box-shadow:0 8px 24px rgba(2,6,23,0.10);border-color:#8ABBFF;background:linear-gradient(180deg,#f6f9ff,#ffffff)}
    /* 代肝种类（服务标题）字号：与游戏品类互换为更小字号 */
    .svc-title{font-size:13px}
    /* 详情区 */
    .right-title{display:flex;justify-content:space-between;align-items:flex-start}
    .price-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:12px;margin-top:14px}
    .price-card{padding:12px;border-radius:10px;border:1px solid var(--border);background:linear-gradient(180deg,#fff,#fbfdff)}
    /* 选中时改为柔和的灰色强调，去掉绿色边框 */
    .price-card.active{border-color:#cbd5e1;box-shadow:0 4px 12px rgba(2,6,23,0.06)}
    .price-card:focus{outline:none}
    .pay-list{margin:0;padding-left:18px}
    .muted{color:var(--muted);font-size:13px}
    .btn{padding:8px 12px;border-radius:8px;border:1px solid var(--border);background:transparent;cursor:pointer}
    .btn-primary{background:var(--accent);color:#fff;border:none}
    .footer{padding:12px;border-top:1px solid var(--border);font-size:13px;color:var(--muted);display:flex;justify-content:space-between;align-items:center}
    .note{font-size:13px;color:var(--muted);background:#f8fafc;padding:10px;border-radius:8px;border:1px dashed var(--border)}
    .contact{font-weight:600}
    .copy-ok{display:inline-block;background:#ecfdf5;color:#065f46;padding:6px 8px;border-radius:6px;font-size:12px;margin-left:8px}
    .hidden{display:none}
    /* Eliya备注：展开收起的平滑过渡（0.1秒） */
    .smooth-toggle{overflow:hidden;transition:max-height 0.1s ease, opacity 0.1s ease;will-change:max-height,opacity}
    /* 支付切换与二维码面板 */
    .pay-toggle{display:flex;gap:8px;margin:8px 0}
    .pill{padding:6px 12px;border-radius:999px;border:1px solid var(--border);background:#fff;cursor:pointer}
    .pill.active{background:var(--accent);color:#fff;border-color:var(--accent)}
    .qr-panel{margin-top:10px;padding:16px;border-radius:12px;border:1px solid var(--border);background:linear-gradient(180deg,#e8fff4,#ffffff);max-width:420px}
    .qr-header{font-weight:600;margin-bottom:8px}
    .qr-box{display:flex;flex-direction:column;align-items:center;gap:12px}
    .qr-box .small{text-align:center}
    #payQrImg{width:240px;border-radius:8px;box-shadow:0 6px 16px rgba(2,6,23,0.08);transition:opacity .3s}
    .fade-out{opacity:0}
    .fade-in{opacity:1}
    /* 支付宝样式：蓝色渐变浅 50%（#8ABBFF -> #FFFFFF） */
    .qr-panel.alipay{background:linear-gradient(180deg,#8ABBFF,#FFFFFF);border-color:var(--border)}
    /* 新增按钮（品类总框右下角） */
    /* 新增按钮固定在外层 panel 的右下角，避免被左侧 .aside 覆盖 */
    .add-category{position:absolute;right:16px;bottom:16px;width:48px;height:48px;border-radius:12px;background:var(--accent);color:#fff;display:flex;align-items:center;justify-content:center;font-size:28px;cursor:pointer;border:none;box-shadow:0 8px 20px rgba(16,185,129,0.18);z-index:20}
    /* 返回顶部按钮：与新增按钮同尺寸，位于其正上方，仅在手机端显示并在滚动一定距离后出现 */
    .back-to-top{position:fixed;right:16px;bottom:16px;width:48px;height:48px;border-radius:12px;background:#64748b;color:#fff;display:none;align-items:center;justify-content:center;font-size:20px;cursor:pointer;border:none;box-shadow:0 8px 20px rgba(2,6,23,0.18);z-index:1000;pointer-events:auto}
    @media (max-width: 768px){
      .back-to-top.show{display:flex}
    }
    /* 居中提示（保存成功） */
    #toast{position:fixed;left:50%;top:50%;transform:translate(-50%,-50%);background:rgba(15,23,42,0.92);color:#fff;padding:10px 14px;border-radius:10px;font-size:14px;z-index:2000;display:none;box-shadow:0 8px 20px rgba(2,6,23,0.28)}
    #toast.show{display:block;animation:fadeToast .18s ease-out}
    @keyframes fadeToast{from{opacity:0;transform:translate(-50%,-60%) scale(0.98)}to{opacity:1;transform:translate(-50%,-50%) scale(1)}}
    /* 模态框 */
    .modal-backdrop{position:fixed;inset:0;background:rgba(2,6,23,0.45);display:none;align-items:center;justify-content:center;z-index:60}
    .modal{width:680px;max-width:95%;background:#fff;/* Eliya备注：模态框整体方框圆角在这里的 border-radius；边框颜色在这里的 border 的颜色变量 */border-radius:12px;padding:16px;border:1px solid var(--border)} 
    .form-row{display:flex;gap:8px;margin-bottom:8px}
    .form-row input,.form-row textarea{flex:1;padding:8px;border:1px solid var(--border);/* Eliya备注：输入框边框颜色在这里的 border；输入框圆角在这里的 border-radius */border-radius:8px}
    .small{font-size:12px;color:var(--muted)}
    .draggable-ghost{opacity:0.6;border:2px dashed #cbd5e1;background:linear-gradient(180deg,#fff,#fff)}    
    
    /* 价格计算面板 */
    .calc-panel{margin-top:14px;padding:12px;border-radius:10px;border:1px solid var(--border);background:#fff}
    .calc-row{display:flex;align-items:center;gap:12px;margin-top:10px}
    .qty-btn{width:42px;height:42px;border-radius:8px;border:1px solid var(--border);background:#fff;font-size:24px;line-height:1;cursor:pointer}
    .qty-input{width:90px;padding:8px;border:1px solid var(--border);border-radius:8px;font-size:18px;text-align:center}
    .total-box{min-width:160px;padding:10px 12px;border:1px solid var(--border);border-radius:10px;background:linear-gradient(180deg,#fff,#fbfdff);font-size:22px;font-weight:700}
    /* 点按反馈：按下缩小10%，松开恢复 */
    .pressable{transition:transform .10s ease-out;transform-origin:center center}
    .pressable.pressed{transform:scale(0.9)}
    /* 黑色主题覆盖：去掉渐变，统一改为靠内偏灰色的纯底色（不影响二维码面板） */
    html[data-theme="black"] body{color:#f8fafc}
    html[data-theme="black"] .panel,
    html[data-theme="black"] .aside,
    html[data-theme="black"] .menu,
    html[data-theme="black"] .service,
    html[data-theme="black"] .price-card,
    html[data-theme="black"] .btn,
    html[data-theme="black"] .footer,
    html[data-theme="black"] .note,
    html[data-theme="black"] .modal,
    html[data-theme="black"] .pill,
    html[data-theme="black"] .more-btn,
    html[data-theme="black"] .menu,
    html[data-theme="black"] .subset,
    html[data-theme="black"] .service,
    html[data-theme="black"] .price-card,
    html[data-theme="black"] .calc-panel,
    html[data-theme="black"] .qty-btn,
    html[data-theme="black"] .qty-input,
    html[data-theme="black"] .total-box,
    html[data-theme="black"] .qr-panel,
    html[data-theme="black"] .search input,
    html[data-theme="black"] .form-row input,
    html[data-theme="black"] .form-row textarea,
    html[data-theme="black"] .svc-row,
    html[data-theme="black"] .game-card{
      background: var(--card) !important;
      color: #e5e7eb !important;
      border: 1px solid var(--border) !important;
    }

    /* Number input text and caret visible in dark theme */
    html[data-theme="black"] .qty-input,
    html[data-theme="black"] input[type="number"]{
      color: #e5e7eb !important;
      caret-color: #e5e7eb !important;
      background: var(--card) !important;
      border: 1px solid var(--border) !important;
    }

    /* Apply dark card background to any remaining white divs */
    html[data-theme="black"] div {
      background: var(--card) !important;
      color: #e5e7eb;
      border-color: var(--border);
    }

    /* Dim QR image in black theme to avoid glare while keeping scan reliability */
    html[data-theme="black"] .qr-panel #payQrImg {
      filter: brightness(0.78) contrast(1.08) saturate(0.9);
      box-shadow: 0 6px 16px rgba(0,0,0,0.45);
    }

    /* 黑色主题滚动条样式（桌面浏览器 + Firefox） */
    html[data-theme="black"] { scrollbar-width: thin; scrollbar-color: #4a4a4a #121212; }
    html[data-theme="black"]::-webkit-scrollbar { width: 12px; height: 12px; }
    html[data-theme="black"]::-webkit-scrollbar-track { background: #121212; border-left: 1px solid var(--border); }
    html[data-theme="black"]::-webkit-scrollbar-thumb { background: #3a3a3a; border-radius: 8px; border: 2px solid #121212; }
    html[data-theme="black"]::-webkit-scrollbar-thumb:hover { background: #505050; }
    /* 侧栏自身滚动条（确保在含 overflow 的容器上也应用） */
    html[data-theme="black"] .aside { scrollbar-width: thin; scrollbar-color: #4a4a4a #121212; }
    html[data-theme="black"] .aside::-webkit-scrollbar { width: 12px; }
    html[data-theme="black"] .aside::-webkit-scrollbar-track { background: #121212; }
    html[data-theme="black"] .aside::-webkit-scrollbar-thumb { background: #3a3a3a; border-radius: 8px; border: 2px solid #121212; }
    /* 黑色主题下的游戏品类展开强调（夜间标准） */
    html[data-theme="black"] .game-card.active-cat{background:#232323 !important;border-color: var(--accent) !important;box-shadow:0 8px 24px rgba(0,0,0,0.35)}
    /* 黑色主题下的展开强调（夜间标准） */
    html[data-theme="black"] .service.active-svc{background:#232323 !important;border-color: var(--accent) !important;box-shadow:0 8px 24px rgba(0,0,0,0.35)}
    /* 黑色主题：标签/提示颜色为浅灰 */
html[data-theme="black"] .tag,
html[data-theme="black"] .muted,
html[data-theme="black"] .toggleIndicator{
  color: var(--muted) !important;
}
/* 深色主题下把手改为蓝色系（仅视觉变化，无实际拖拽功能） */
html[data-theme="black"] .handle .bar{ background: #8ABBFF !important; }
html[data-theme="black"] .drag-handle .bar{ background: #8ABBFF !important; }
/* 深色主题下右下“三点”改为蓝色系，确保可见性 */
html[data-theme="black"] .dot{ background: #8ABBFF !important; }

    /* 其它主题的滚动条样式：与各主题主色（accent）和背景（bg）协调 */
    html[data-theme="white"] { scrollbar-width: thin; scrollbar-color: var(--accent) var(--bg); }
    html[data-theme="white"]::-webkit-scrollbar { width: 12px; height: 12px; }
    html[data-theme="white"]::-webkit-scrollbar-track { background: var(--bg); border-left: 1px solid var(--border); }
    html[data-theme="white"]::-webkit-scrollbar-thumb { background: var(--accent); border-radius: 8px; border: 2px solid var(--bg); }
    html[data-theme="white"] .aside { scrollbar-width: thin; scrollbar-color: var(--accent) var(--bg); }
    html[data-theme="white"] .aside::-webkit-scrollbar { width: 12px; }
    html[data-theme="white"] .aside::-webkit-scrollbar-track { background: var(--bg); }
    html[data-theme="white"] .aside::-webkit-scrollbar-thumb { background: var(--accent); border-radius: 8px; border: 2px solid var(--bg); }

    html[data-theme="pink"] { scrollbar-width: thin; scrollbar-color: var(--accent) var(--bg); }
    html[data-theme="pink"]::-webkit-scrollbar { width: 12px; height: 12px; }
    html[data-theme="pink"]::-webkit-scrollbar-track { background: var(--bg); border-left: 1px solid var(--border); }
    html[data-theme="pink"]::-webkit-scrollbar-thumb { background: var(--accent); border-radius: 8px; border: 2px solid var(--bg); }
    html[data-theme="pink"] .aside { scrollbar-width: thin; scrollbar-color: var(--accent) var(--bg); }
    html[data-theme="pink"] .aside::-webkit-scrollbar { width: 12px; }
    html[data-theme="pink"] .aside::-webkit-scrollbar-track { background: var(--bg); }
    html[data-theme="pink"] .aside::-webkit-scrollbar-thumb { background: var(--accent); border-radius: 8px; border: 2px solid var(--bg); }

    html[data-theme="lime"] { scrollbar-width: thin; scrollbar-color: var(--accent) var(--bg); }
    html[data-theme="lime"]::-webkit-scrollbar { width: 12px; height: 12px; }
    html[data-theme="lime"]::-webkit-scrollbar-track { background: var(--bg); border-left: 1px solid var(--border); }
    html[data-theme="lime"]::-webkit-scrollbar-thumb { background: var(--accent); border-radius: 8px; border: 2px solid var(--bg); }
    html[data-theme="lime"] .aside { scrollbar-width: thin; scrollbar-color: var(--accent) var(--bg); }
    html[data-theme="lime"] .aside::-webkit-scrollbar { width: 12px; }
    html[data-theme="lime"] .aside::-webkit-scrollbar-track { background: var(--bg); }
    html[data-theme="lime"] .aside::-webkit-scrollbar-thumb { background: var(--accent); border-radius: 8px; border: 2px solid var(--bg); }

    html[data-theme="orange"] { scrollbar-width: thin; scrollbar-color: var(--accent) var(--bg); }
    html[data-theme="orange"]::-webkit-scrollbar { width: 12px; height: 12px; }
    html[data-theme="orange"]::-webkit-scrollbar-track { background: var(--bg); border-left: 1px solid var(--border); }
    html[data-theme="orange"]::-webkit-scrollbar-thumb { background: var(--accent); border-radius: 8px; border: 2px solid var(--bg); }
    html[data-theme="orange"] .aside { scrollbar-width: thin; scrollbar-color: var(--accent) var(--bg); }
    html[data-theme="orange"] .aside::-webkit-scrollbar { width: 12px; }
    html[data-theme="orange"] .aside::-webkit-scrollbar-track { background: var(--bg); }
    html[data-theme="orange"] .aside::-webkit-scrollbar-thumb { background: var(--accent); border-radius: 8px; border: 2px solid var(--bg); }

    /* ------------------ 移动端优化（≤600px） ------------------ */
    @media (max-width:600px){
      .wrap{max-width:100%;padding:12px}
      .panel{border-radius:10px}
      .aside{height:auto;max-height:none;overflow:visible;border-right:none;border-top:1px solid var(--border);padding:12px}
      .main{padding:12px}
      .panel-header{flex-wrap:wrap;gap:8px}
      .top-controls{width:100%;justify-content:flex-start}
      h1{font-size:20px}
      .game-card{padding:10px}
      .meta{font-size:16px}
      .tag{font-size:12px}
      .more-btn{width:30px;height:30px}
      .price-grid{grid-template-columns:1fr}
      .qr-box{flex-direction:column;align-items:center}
      #payQrImg{width:min(70vw,160px)}
      .qty-btn{width:36px;height:36px;font-size:22px}
      .qty-input{width:72px;font-size:16px}
      .total-box{min-width:120px;font-size:20px}
      .footer{flex-direction:column;gap:8px}
      /* 避免按钮被内容遮挡：小屏使用固定定位 */
      .add-category{position:fixed;right:14px;bottom:14px}
      /* 文本过长时自动换行，避免溢出 */
      #contactVal{overflow-wrap:anywhere;word-break:break-all}
    }
  </style>
</head>
<body>
  <h1 class="mobile-title">小鹿帮帮</h1>
  <style>
    /* 默认隐藏移动端标题（桌面端不显示） */
    .mobile-title{display:none}
    @media (max-width:600px){
      .mobile-title{display:block;font-size:20px;margin:16px 16px 0 16px}
      .panel-header .desktop-title{display:none}
      /* 让标题更贴近方框顶部：设置上内边距为 10px */
      .wrap{padding-top:0px}
    }
  </style>
  <div class="wrap">
    <div class="panel">
      <div class="panel-header">
        <div>
          <h1 class="desktop-title" style="margin:0">小鹿帮帮</h1>
          <div class="small muted top-hint">选择游戏 → 展开项目 → 查看报价与联系方式</div>
        </div>

        <!-- 主题选择器：切换页面主题颜色 -->
        <div class="top-controls">
          <div class="theme-chooser small muted">主题：</div>
          <div id="themes" class="theme-chooser" aria-hidden="false">
            <button class="theme-btn" title="黑色" data-theme="black" style="background:#0f172a"></button>
            <button class="theme-btn" title="白色" data-theme="white" style="background:#ffffff;border:1px solid #ddd"></button>
            <button class="theme-btn" title="浅红色" data-theme="pink" style="background:#ffefef"></button>
            <button class="theme-btn" title="黄绿色" data-theme="lime" style="background:#e6ffdb"></button>
            <button class="theme-btn" title="橙色" data-theme="orange" style="background:#fff4e6"></button>
          </div>
          <!-- 文件保存/导入按钮（顶部工具栏，不改变现有布局） -->
          <div class="file-io" style="display:flex;gap:8px">
            <button id="btnSaveFile" class="btn btn-primary" title="保存到 JSON 文件">保存到文件</button>
            <button id="btnLoadFile" class="btn" title="从 JSON 文件导入">从文件导入</button>
          </div>
        </div>
      </div>

      <div class="grid">
        <aside class="aside">
          <div class="search">
            <input id="q" placeholder="搜索游戏或服务（示例：段位、素材）" />
            <button id="clear" class="btn">清除</button>
          </div>

          <!-- 游戏列表容器（可拖拽排序） -->
          <div id="games" aria-live="polite"></div>

          <!-- 新增品类按钮已移至外层 panel 的右下角，避免遮挡滚动条 -->

          <!-- Eliya备注：提示语暂时隐藏 -->
          <div style="margin-top:12px;font-size:13px;color:var(--muted);display:none">
            提示：点击某个服务后右侧会显示详细价格与下单方式。你可以把示例数据替换为真实商品与价格。
          </div>
        </aside>

        <main class="main">
          <div id="detailPlaceholder">
            <div class="note">请选择左侧的游戏与服务查看详情</div>
          </div>

          <div id="detailPanel" class="hidden">
            <div class="right-title">
              <div>
                <div id="svcTitle" style="font-size:20px;font-weight:700"></div>
                <div id="svcMeta" class="muted" style="margin-top:6px"></div>
              </div>
              <div id="contactBlock" class="muted">联系方式：<span id="contactVal" class="contact"></span></div>
            </div>

            <div class="price-grid" style="margin-top:16px">
              <div style="min-width:240px">
                <div style="font-weight:600;margin-bottom:8px">价格选项</div>
                <div id="prices"></div>
                
                <!-- 价格计算面板（放在左侧） -->
                <div id="calcPanel" class="calc-panel" aria-label="价格计算">
                  <div style="font-weight:600">价格计算</div>
                  <div class="calc-row">
                    <span class="muted">数量：</span>
                    <button id="qtyMinus" class="qty-btn" aria-label="减少数量">−</button>
                    <input id="qtyInput" class="qty-input" type="number" min="0" step="1" value="0" />
                    <button id="qtyPlus" class="qty-btn" aria-label="增加数量">+</button>
                  </div>
                  <div class="calc-row">
                    <span class="muted">价格：</span>
                    <div id="totalPrice" class="total-box">¥0</div>
                    <div id="unitPriceHint" class="small muted"></div>
                  </div>
                </div>

                <!-- 下单示例流程（放在左侧） -->
                <div style="margin-top:12px;font-size:13px;color:var(--muted)">
                  下单示例流程：
                  <ol style="padding-left:18px;margin-top:6px">
                    <li>复制联系方式并添加客服/发工单</li>
                    <li>说明游戏、服务器、当前段位与目标、期望时限</li>
                    <li>付款并截图，提供订单编号</li>
                    <li>客服确认后安排代练并提供进度截图</li>
                  </ol>
                </div>
              </div>
              <div>
                <div style="font-weight:600;margin-bottom:8px">支付方式 & 下单</div>
                <div class="muted">支持：</div>
                <ul id="pays" class="pay-list"></ul>

                <!-- 支付切换与二维码展示 -->
                <div id="payToggle" class="pay-toggle" aria-label="选择支付方式">
                  <button type="button" class="pill active" data-pay="wechat">微信</button>
                  <button type="button" class="pill" data-pay="alipay">支付宝</button>
                </div>
                <div id="qrPanel" class="qr-panel">
                  <div class="qr-header">推荐使用<span id="qrTitlePay">微信</span>支付</div>
                  <div class="qr-box">
        <picture class="qr-img-wrap">
          <source type="image/webp" srcset="微信收款码.webp" />
          <img id="payQrImg" src="微信收款码.png" alt="收款码" decoding="async" fetchpriority="high" />
        </picture>
                    <div id="qrHint" class="small muted">请使用对应 App 扫码付款</div>
                  </div>
                </div>

                <div style="margin-top:12px;display:flex;gap:8px">
                  <button id="copyBtn" class="btn btn-primary">复制联系方式</button>
                  <button id="payGuide" class="btn">查看付款说明</button>
                </div>

              </div>
            </div>

            <div style="margin-top:14px" class="note">
              安全与协议（示例）：代练过程中不承担账号因违反游戏条款被封的全部责任，代练前请做好账号备份并设置合理权限。
            </div>
          </div>
        </main>
      </div>

      <!-- 手机端优化：返回顶部按钮（与新增按钮同尺寸，位于其正上方，仅在下滑一段后显示） -->
<button id="backToTopBtn" class="back-to-top" title="重置" aria-label="重置">
  <svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true">
    <!-- 圆形箭头（刷新/重置样式）：顶部留缺口并配三角形箭头，风格与现有线性图标一致 -->
    <circle cx="12" cy="12" r="9" fill="none" stroke="currentColor" stroke-width="3.5" stroke-linecap="round" stroke-dasharray="44 18" />
    <!-- 将三角箭头放大 2 倍（以中心约 (19.33, 8.5) 为参考） -->
    <!-- 逆时针旋转 90°，在中心约 (19.67, 8.5) 处进行变换；撤销“变窄20%”，改为“变矮20%”：宽度维持 1.5 倍，高度为 1.2 倍 -->
    <path d="M17.67 4.5 L22.67 8.5 L17.67 12.5 Z" fill="currentColor" transform="translate(20.67,8.5) rotate(-90) scale(1.5,1.2) translate(-19.67,-8.5) translate(-1.2,-0.2)" />
  </svg>
</button>
      

      <div class="footer">
        <div>说明：这里是说明还不知道说什么。</div>
        <div class="small muted"> </div>
      </div>
    </div>
  </div>

  

<script>
/* ------------------
   代码注释：
   - 不再使用浏览器 localStorage 保存 DATA 或主题；数据由 data-autoload.js 从 数据库/ JSON 加载。
   - saveData(): 保留调用但不做任何本地持久化。
   - loadData(): 初始返回空列表，等待 data-autoload.js 覆盖并渲染。
   - renderList(): 渲染左侧的游戏列表（包含拖拽把手和三点菜单）。
   - openModal() / closeModal(): 管理新增/编辑模态窗口。
  ------------------ */

const localStorageKey = 'boost_DATA_v1';
const themeKey = 'boost_theme_v1';

/* 默认示例数据已移除：如果 localStorage 没数据则为空列表 */
const DEFAULT_DATA = [];

// 尝试从 localStorage 读取，如果没有则使用默认
let DATA = loadData();

// DOM 引用
const gamesEl = document.getElementById('games');
const qEl = document.getElementById('q');
const clearBtn = document.getElementById('clear');
const detailPanel = document.getElementById('detailPanel');
const detailPlaceholder = document.getElementById('detailPlaceholder');
const svcTitle = document.getElementById('svcTitle');
const svcMeta = document.getElementById('svcMeta');
const contactVal = document.getElementById('contactVal');
const pricesEl = document.getElementById('prices');
const paysEl = document.getElementById('pays');
const copyBtn = document.getElementById('copyBtn');
const payGuide = document.getElementById('payGuide');
// 价格计算相关元素
const qtyMinus = document.getElementById('qtyMinus');
const qtyPlus = document.getElementById('qtyPlus');
const qtyInput = document.getElementById('qtyInput');
const totalPriceEl = document.getElementById('totalPrice');
const unitPriceHint = document.getElementById('unitPriceHint');
const addCategoryBtn = document.getElementById('addCategoryBtn');
const modalBack = document.getElementById('modalBack');
const modalTitle = document.getElementById('modalTitle');
const modalSave = document.getElementById('modalSave');
const modalCancel = document.getElementById('modalCancel');
const btnSaveFile = document.getElementById('btnSaveFile');
const btnLoadFile = document.getElementById('btnLoadFile');

// modal inputs（移除单一服务输入，改为多服务容器）
const inpName = document.getElementById('inpName');
const inpTag = document.getElementById('inpTag');
const servicesContainer = document.getElementById('servicesContainer');
const btnAddService = document.getElementById('btnAddService');
const inpPayments = document.getElementById('inpPayments');
const inpContactType = document.getElementById('inpContactType');
const inpContactValue = document.getElementById('inpContactValue');
  // 支付切换与二维码相关元素
  const payToggle = document.getElementById('payToggle');
  const qrPanel = document.getElementById('qrPanel');
  const payQrImg = document.getElementById('payQrImg');
  const qrTitlePay = document.getElementById('qrTitlePay');
  const qrHint = document.getElementById('qrHint');

  // Toast 提示（居中）
  let __toastTimer = null;
  function showToast(message=''){
    try{
      let toast = document.getElementById('toast');
      if(!toast){
        toast = document.createElement('div');
        toast.id = 'toast';
        document.body.appendChild(toast);
      }
      toast.textContent = message || '';
      toast.classList.add('show');
      if(__toastTimer) clearTimeout(__toastTimer);
      __toastTimer = setTimeout(()=>{ try{ toast.classList.remove('show'); }catch(e){} }, 1600);
    }catch(e){}
  }

  // 手机端提示语与点击保存
  function updateQrHintForViewport(){
    try{
      const isMobile600 = window.matchMedia && window.matchMedia('(max-width: 600px)').matches;
      if(qrHint){
        qrHint.textContent = isMobile600 ? '连续点击两次下载图片' : '请使用对应 App 扫码付款';
      }
    }catch(e){}
  }
  updateQrHintForViewport();
  window.addEventListener('resize', updateQrHintForViewport);

  // 手机端：将“点击下载”改为“连续点击两次（≤0.2s）下载 PNG”，避免误触
  if(payQrImg){
    let __qrLastTap = 0;
    let __qrIgnoreClicksUntil = 0; // 防止 touchend 后的 click 重复触发
    const triggerDownloadPNG = ()=>{
      try{
        const type = (qrPanel && qrPanel.classList && qrPanel.classList.contains('alipay')) ? 'alipay' : 'wechat';
        const baseName = type === 'alipay' ? '支付宝收款码' : '微信收款码';
        const png = baseName + '.png';
        const a = document.createElement('a');
        a.href = png; // 始终下载 PNG
        const payName = (qrTitlePay && qrTitlePay.textContent) ? qrTitlePay.textContent.trim() : '';
        a.download = (payName || '收款码') + '.png';
        document.body.appendChild(a);
        a.click();
        setTimeout(()=>{ try{ document.body.removeChild(a); }catch(e){} }, 0);
        showToast('收款码已保存');
      }catch(e){}
    };
    const handleTap = ()=>{
      try{
        const isMobile600 = window.matchMedia && window.matchMedia('(max-width: 600px)').matches;
        if(!isMobile600) return;
        const now = Date.now();
        if(now - __qrLastTap <= 200){
          if(now < __qrIgnoreClicksUntil) return;
          __qrIgnoreClicksUntil = now + 400;
          triggerDownloadPNG();
          __qrLastTap = 0;
        }else{
          __qrLastTap = now;
        }
      }catch(e){}
    };
    // 触屏设备优先使用 Pointer 事件；不与 touch/click 混用，避免一次单击被识别成双击
    if(window.PointerEvent){
      payQrImg.addEventListener('pointerup', (e)=>{ if(e.pointerType==='touch') handleTap(); }, { passive: true });
    }else{
      // 旧设备回退到 touchend
      payQrImg.addEventListener('touchend', handleTap, { passive: true });
    }
  }

let currentService = null; // 当前选中的服务（用于详情区显示与复制）
let selectedUnitPrice = 0; // 当前选中的单价（用于价格计算）
let selectedLabel = '';
// 全局折扣配置（可在左下角按钮修改）
window.DISCOUNT_CONFIG = window.DISCOUNT_CONFIG || {
  more: { p2: 0.08, p3: 0.09, p4plus: 0.10, cap: 0.10 },
  second: { p: 0.10, cap: 0.10 }
};

// --- 动态服务行生成 ---
function makeServiceRow(svc = { title: '', desc: '', priceOptions: [{ label: '', price: undefined }], discount: { enabled: false, type: 'more' } }) {
  const row = document.createElement('div');
  row.className = 'svc-row';
  row.style.border = '1px solid var(--border)'; // Eliya备注：服务项方框的边框颜色在这里，修改 var(--border)
  row.style.borderRadius = '10px'; // Eliya备注：服务项方框圆角度数在这里，改 10px
  row.style.padding = '10px';
  row.style.margin = '10px 0';
  row.style.background = 'var(--card)'; // Eliya备注：服务项方框背景色在这里，修改 var(--card)

  const title = document.createElement('input');
  title.placeholder = '服务标题';
  title.value = svc.title || '';
  title.style.marginBottom = '8px';
  title.style.width = '100%';

  const desc = document.createElement('input');
  desc.placeholder = '服务描述';
  desc.value = svc.desc || '';
  desc.style.marginBottom = '8px';
  desc.style.width = '100%';

  const prrow = document.createElement('div');
  prrow.style.display = 'flex';
  prrow.style.gap = '8px';
  prrow.style.marginBottom = '8px';

  const priceLabel = document.createElement('input');
  priceLabel.placeholder = '单位（例如：月/次/周）或选项标签';
  priceLabel.value = (svc.priceOptions && svc.priceOptions[0] && svc.priceOptions[0].label) || '';
  priceLabel.style.flex = '1';

  const priceValue = document.createElement('input');
  priceValue.placeholder = '单价';
  priceValue.type = 'number';
  const hasPrice = !!(svc.priceOptions && svc.priceOptions[0] && (typeof svc.priceOptions[0].price !== 'undefined'));
  priceValue.value = hasPrice ? String(svc.priceOptions[0].price) : '';
  priceValue.style.width = '140px';

  prrow.appendChild(priceLabel);
  prrow.appendChild(priceValue);

  // 折扣设置：参与折扣 + 折扣方式
  const discountRow = document.createElement('div');
  discountRow.style.display = 'flex';
  discountRow.style.alignItems = 'center';
  discountRow.style.gap = '12px';
  discountRow.style.marginBottom = '8px';

  const discountLabel = document.createElement('label');
  discountLabel.style.display = 'flex';
  discountLabel.style.alignItems = 'center';
  discountLabel.style.gap = '6px';

  const discountEnabled = document.createElement('input');
  discountEnabled.type = 'checkbox';
  discountEnabled.checked = !!(svc.discount && svc.discount.enabled);
  const discountEnabledText = document.createElement('span');
  discountEnabledText.textContent = '参与折扣';
  discountLabel.appendChild(discountEnabled);
  discountLabel.appendChild(discountEnabledText);

  const discountType = document.createElement('select');
  discountType.style.minWidth = '180px';
  discountType.innerHTML = `
    <option value="more">越多越便宜</option>
    <option value="second">第二份开始打折</option>
    <option value="conditional">满足条件时打折（暂不实现）</option>
  `;
  discountType.value = (svc.discount && svc.discount.type) || 'more';
  // 勾选时显示下拉
  const updateDiscountUI = ()=>{
    discountType.style.display = discountEnabled.checked ? '' : 'none';
  };
  updateDiscountUI();
  discountEnabled.addEventListener('change', updateDiscountUI);

  discountRow.appendChild(discountLabel);
  discountRow.appendChild(discountType);

  const del = document.createElement('button');
  del.className = 'btn';
  del.textContent = '删除此服务';
  del.style.color = '#b91c1c';
  del.style.borderColor = '#ef4444';
  del.onclick = () => {
    row.remove();
  };

  row.appendChild(title);
  row.appendChild(desc);
  row.appendChild(prrow);
  row.appendChild(discountRow);
  row.appendChild(del);

  // 存储引用，便于采集
  row._refs = { title, desc, priceLabel, priceValue, discountEnabled, discountType };
  return row;
}

// --- 从UI采集多个服务 ---
function getServicesFromUI(gameId) {
  const rows = Array.from(servicesContainer.querySelectorAll('.svc-row'));
  // 下拉选择：wechat / alipay / both
  const sel = inpPayments.value || 'both';
  const pays = sel === 'wechat' ? ['微信'] : (sel === 'alipay' ? ['支付宝'] : ['微信','支付宝']);
  const ctype = inpContactType.value.trim();
  const cval = inpContactValue.value.trim();
  return rows.map((row, idx) => {
    const { title, desc, priceLabel, priceValue, discountEnabled, discountType } = row._refs || {};
    const t = (title && title.value.trim()) || '未命名服务';
    const d = (desc && desc.value.trim()) || '';
    const pl = (priceLabel && priceLabel.value.trim()) || '单次';
    const pv = Number((priceValue && priceValue.value) || 0) || 0;
    const disEnabled = !!(discountEnabled && discountEnabled.checked);
    const disType = (discountType && discountType.value) || 'more';
    return {
      id: `${gameId}-${idx + 1}`,
      title: t,
      desc: d,
      priceOptions: [{ label: pl, price: pv }],
      discount: { enabled: disEnabled, type: disType },
      paymentMethods: pays,
      contact: { type: ctype || '微信', value: cval || '' }
    };
  });
}

/* ------------------ 本地存储工具函数（禁用本地记忆） ------------------ */
function saveData(){ /* 不进行任何本地持久化 */ }
function loadData(){ return JSON.parse(JSON.stringify(DEFAULT_DATA)); }

/* ------------------ 文件保存/导入（优先使用文件系统访问 API） ------------------ */
function serializeBackup(){
  const theme = document.documentElement.getAttribute('data-theme') || 'white';
  // 直接使用内存中的 DATA（已包含你在页面上的所有修改）
  return { data: DATA, theme, discountConfig: window.DISCOUNT_CONFIG };
}

async function saveToFile(){
  const payload = JSON.stringify(serializeBackup(), null, 2);
  try{
    if('showSaveFilePicker' in window){
      const handle = await window.showSaveFilePicker({
        suggestedName: 'newdata.json',
        types: [{ description: 'JSON 文件', accept: { 'application/json': ['.json'] } }]
      });
      const writable = await handle.createWritable();
      await writable.write(payload);
      await writable.close();
      alert('已保存到文件。');
    }else{
      // 回退：触发下载到本地
      const blob = new Blob([payload], { type: 'application/json' });
      const a = document.createElement('a');
      a.href = URL.createObjectURL(blob);
      a.download = 'newdata.json';
      document.body.appendChild(a);
      a.click();
      URL.revokeObjectURL(a.href);
      a.remove();
      alert('已生成下载文件，请选择保存到目标文件夹。');
    }
  }catch(e){
    console.error('保存失败', e);
    alert('保存失败：'+ e.message);
  }
}

async function loadFromFile(){
  try{
    if('showOpenFilePicker' in window){
      const [handle] = await window.showOpenFilePicker({
        types: [{ description: 'JSON 文件', accept: { 'application/json': ['.json'] } }]
      });
      const file = await handle.getFile();
      const text = await file.text();
      applyBackupJSON(text);
    }else{
      // 回退：使用 <input type="file"> 选择文件
      const input = document.createElement('input');
      input.type = 'file';
      input.accept = '.json,application/json';
      input.onchange = async ()=>{
        const file = input.files && input.files[0];
        if(!file) return;
        const text = await file.text();
        applyBackupJSON(text);
      };
      input.click();
    }
  }catch(e){
    console.error('导入失败', e);
    alert('导入失败：'+ e.message);
  }
}

function applyBackupJSON(text){
  try{
    const obj = JSON.parse(text);
    if(!obj || !obj.data || !Array.isArray(obj.data)) throw new Error('文件格式不正确');
    DATA = obj.data;
    // 不进行本地持久化
    // 恢复主题：优先使用本地记忆，其次使用文件内主题，默认白色
    (function(){
      let saved = null;
      try{ saved = localStorage.getItem('boost_theme_v1'); }catch(e){}
      applyTheme(saved || (obj.theme || 'white'));
    })();
    // 重新渲染左侧列表
    renderList(qEl.value || '');
    // 回到占位区
  /* Eliya备注：隐藏右侧详情改为平滑动画 */
  smoothHide(detailPanel);
  detailPlaceholder.classList.remove('hidden');
    alert('导入成功，已恢复数据');
  }catch(e){
    console.error('文件解析失败', e);
    alert('文件解析失败：'+ e.message);
  }
}

/* ------------------ 渲染函数：把 DATA 渲染到左侧列表 ------------------ */
function renderList(filter='') {
  gamesEl.innerHTML = '';
  const q = filter.trim().toLowerCase();
  const filtered = q ? DATA.map(g=>({...g, services:g.services.filter(s=>s.title.toLowerCase().includes(q)||s.desc.toLowerCase().includes(q)||g.name.toLowerCase().includes(q))})).filter(g=>g.services.length) : DATA;
  if(filtered.length===0){
    gamesEl.innerHTML = '<div style="color:var(--muted);font-size:13px;padding:10px">未找到匹配项，试试更宽泛的关键词。</div>';
    return;
  }

  filtered.forEach((game, gameIndex)=>{
    const wrap = document.createElement('div');
    wrap.className = 'game';
    wrap.dataset.gameId = game.id;

    // 内部一行：仅卡片主体（公开站点不提供拖拽与更多菜单）
    const row = document.createElement('div');
    row.className = 'game-row';

    // ===== 卡片主体（游戏名 + 标签 + toggleIndicator） =====
    const card = document.createElement('div');
    card.className = 'game-card';
    card.innerHTML = `<div style="display:flex;flex-direction:column;gap:4px">
                        <div style="font-weight:600" class="meta">${game.name}</div>
                        <div class="tag" style="font-size:13px;color:var(--muted)">${game.tag}</div>
                      </div>
                      <div class="toggleIndicator" style="font-size:20px;color:var(--muted);padding-left:8px">+</div>`;

    // 左侧拖拽把手（仅作为装饰）
    const handle = document.createElement('div');
    handle.className = 'handle';
    handle.setAttribute('aria-hidden','true');
    handle.title = '拖拽把手（装饰）';
    handle.innerHTML = '<div><div class="bar"></div><div class="bar"></div><div class="bar"></div></div>';
    row.appendChild(handle);

    // 卡片主体
    row.appendChild(card);

    // 不添加更多菜单（编辑/删除）

    // 把这一行加入 wrap
    wrap.appendChild(row);

    // ===== 服务列表（默认折叠，点击卡片时淡入/滑出，0.1s 动效，仅 transform/opacity） =====
    const srvWrap = document.createElement('div');
    srvWrap.className = 'services';
    srvWrap.setAttribute('aria-hidden','true');
    const srvInner = document.createElement('div');
    srvInner.className = 'anim-content';
    srvWrap.appendChild(srvInner);
    // 按“子集”分组展示（支持同名子集，基于 subsetId 区分）。
    // 若无显式 subsets，则按服务的 subset 名称推断，并为缺失的服务补充 subsetId。
    let subsets = Array.isArray(game.subsets) ? game.subsets.slice() : null;
    if(!subsets){
      const map = {};
      (game.services||[]).forEach(s=>{
        const nm = s.subset || '代肝项目';
        if(!map[nm]){ map[nm] = { id: 'ss'+Date.now()+'-'+Math.floor(Math.random()*100000), name: nm }; }
      });
      subsets = Object.values(map);
      const nameToId = {}; subsets.forEach(ss=>{ nameToId[ss.name] = ss.id; });
      (game.services||[]).forEach(s=>{ if(!s.subsetId){ s.subsetId = nameToId[s.subset || '代肝项目']; } });
    }
    // 创建子集分组及其服务项
    subsets.forEach(ss=>{
      const group = document.createElement('div');
      group.className = 'subset';

      const header = document.createElement('div');
      header.className = 'subset-header';
      header.innerHTML = `<div style="display:flex;flex-direction:column;gap:2px"><div class="subset-name">${ss.name}</div>${ss.remark ? `<div class=\"subset-remark\">${ss.remark}</div>` : ''}</div><div class="toggleIndicator">+</div>`;

      const body = document.createElement('div');
      body.className = 'subset-services';
      const bodyInner = document.createElement('div');
      bodyInner.className = 'anim-content';

      // 填充该子集的服务（按 subsetId 精确匹配；兼容旧数据按名称匹配）
      (game.services||[])
        .filter(svc => svc.subsetId === ss.id || (!svc.subsetId && (svc.subset||'代肝项目') === ss.name))
        .forEach(svc=>{
          const sEl = document.createElement('div');
          sEl.className = 'service';
          sEl.innerHTML = `<div class="svc-title" style="font-weight:600">${svc.title}</div><div class="muted" style="margin-top:6px">${svc.desc}</div>`;
          sEl.addEventListener('click',()=>showService(svc,game,sEl));
          bodyInner.appendChild(sEl);
        });

      // 子集折叠/展开（仅使用 transform/opacity 动画；收起先淡出，再移除 open）
      header.addEventListener('click',()=>{
        const open = body.classList.contains('open');
        if(open){
          body.classList.add('closing');
          body.setAttribute('aria-hidden','true');
          header.querySelector('.toggleIndicator').textContent = '+';
          group.classList.remove('active-subset');
          setTimeout(()=>{ body.classList.remove('open'); body.classList.remove('closing'); }, 130);
        }else{
          body.classList.add('open');
          body.setAttribute('aria-hidden','false');
          header.querySelector('.toggleIndicator').textContent = '-';
          group.classList.add('active-subset');
        }
      });

      group.appendChild(header);
      body.appendChild(bodyInner);
      group.appendChild(body);
      srvInner.appendChild(group);
    });
    wrap.appendChild(srvWrap);

    // =========== 事件绑定 ===========

    // 1) 切换展开/收起服务列表（点击卡片时，仅使用 transform/opacity 动画）
    card.addEventListener('click',()=>{
      const open = srvWrap.classList.contains('open');
      // 折叠其它已打开的服务（这里只影响可见的服务区域）
      document.querySelectorAll('.game .services').forEach(el=>{
        el.classList.remove('open');
        el.classList.remove('closing');
        el.setAttribute('aria-hidden','true');
      });
      document.querySelectorAll('.game .toggleIndicator').forEach(el=>el.textContent='+');
      // 移除所有卡片的强调态
      document.querySelectorAll('.game-card').forEach(el=>el.classList.remove('active-cat'));

      if(open){
        // 收起当前：先淡出，再移除 open
        srvWrap.classList.add('closing');
        srvWrap.setAttribute('aria-hidden','true');
        card.querySelector('.toggleIndicator').textContent = '+';
        card.classList.remove('active-cat');
        setTimeout(()=>{ srvWrap.classList.remove('open'); srvWrap.classList.remove('closing'); }, 130);
      }else{
        // 打开当前：直接添加 open，内容淡入/下滑
        srvWrap.classList.add('open');
        srvWrap.setAttribute('aria-hidden','false');
        // 切换当前指示器为 - 并强调卡片
        card.querySelector('.toggleIndicator').textContent = '-';
        card.classList.add('active-cat');
      }

      // 若是收起该品类，同时收起当前代肝项目的内嵌面板，并重置状态
      if(open){
        try{
          const mobileMount = document.getElementById('mobileDetail');
          if(mobileMount && !mobileMount.classList.contains('hidden')){
            smoothHide(mobileMount);
          }
        }catch(e){}
        try{
          const dp = detailPanel; // 外层已定义
          const priceGridEl = document.querySelector('.price-grid');
          if(dp && priceGridEl && priceGridEl.parentElement !== dp){
            dp.appendChild(priceGridEl);
          }
        }catch(e){}
        try{
          if(window.MOBILE_CURRENT_TARGET){
            window.MOBILE_CURRENT_TARGET.classList.remove('active-svc');
            window.MOBILE_CURRENT_TARGET = null;
          }
        }catch(e){}
      }
    });

    // 公开站点不提供更多菜单与拖拽排序

    gamesEl.appendChild(wrap);
  });
  // 为新渲染的列表元素绑定点按反馈（游戏卡片、服务项、按钮等）
  if(typeof addPressFeedback === 'function'){
    try{ addPressFeedback(document); }catch(e){}
  }
}

/* ------------------ 显示服务详情（右侧面板） ------------------ */
function showService(svc, game, mountTarget){
  currentService = { ...svc, game };
  /* Eliya备注：显示右侧详情改为平滑动画（0.1s） */
  // 针对移动端：将价格与支付模块插入到点击的服务项下方
  const isMobile = window.matchMedia && window.matchMedia('(max-width: 768px)').matches;
  const priceGrid = detailPanel.querySelector('.price-grid');
  let mobileMount = document.getElementById('mobileDetail');
  // 记录当前展开的服务项（用于再次点击收起）
  window.MOBILE_CURRENT_TARGET = window.MOBILE_CURRENT_TARGET || null;
  if(isMobile){
    // 创建或复用移动端挂载容器
    if(!mobileMount){
      mobileMount = document.createElement('div');
      mobileMount.id = 'mobileDetail';
      mobileMount.style.margin = '8px 0 12px';
      mobileMount.style.border = '1px solid var(--border)';
      mobileMount.style.borderRadius = '10px';
      mobileMount.style.background = 'var(--card)';
      mobileMount.style.padding = '12px';
      mobileMount.style.boxShadow = '0 6px 18px rgba(0,0,0,0.08)';
      mobileMount.classList.add('hidden');
    }
    // 移动 priceGrid 到服务项下方显示
    if(priceGrid){
      mobileMount.innerHTML = '';
      mobileMount.appendChild(priceGrid);
    }
    // 挂载到点击的服务项之后
    try{
      if(mountTarget && mountTarget.parentElement){
        const alreadyMountedHere = (mountTarget.nextElementSibling === mobileMount);
        // 若再次点击同一个服务项，则收起
        if(alreadyMountedHere && window.MOBILE_CURRENT_TARGET === mountTarget && !mobileMount.classList.contains('hidden')){
          smoothHide(mobileMount);
          // 将 priceGrid 放回右侧详情面板（桌面端时会用到）
          try{ detailPanel.appendChild(priceGrid); }catch(e){}
          // 去除强调样式
          try{ mountTarget.classList.remove('active-svc'); }catch(e){}
          window.MOBILE_CURRENT_TARGET = null;
          return;
        }
        // 去掉之前的强调样式
        try{ if(window.MOBILE_CURRENT_TARGET && window.MOBILE_CURRENT_TARGET !== mountTarget){ window.MOBILE_CURRENT_TARGET.classList.remove('active-svc'); } }catch(e){}
        mountTarget.insertAdjacentElement('afterend', mobileMount);
      }
    }catch(e){}
    // 隐藏右侧详情面板，避免重复显示
    smoothHide(detailPanel);
    detailPlaceholder.classList.add('hidden');
    // 展开动画并滚动到可视区域
    smoothShow(mobileMount);
    // 添加强调样式
    try{ if(mountTarget){ mountTarget.classList.add('active-svc'); } }catch(e){}
    window.MOBILE_CURRENT_TARGET = mountTarget || null;
    // 为所有分类的展开都进行自动滚动：延时在动画触发后执行，且滚动到服务项本身更稳妥
    try{
      const isMobileNow = window.innerWidth <= 768;
      if(isMobileNow){
        setTimeout(()=>{
          try{ (mountTarget || mobileMount).scrollIntoView({ behavior: 'smooth', block: 'start' }); }catch(e){}
        }, 140); // 等待 smoothShow 开始展开后再滚动
      }
    }catch(e){}
  } else {
    // 桌面端：确保 priceGrid 回到右侧详情面板，并显示该面板
    try{
      if(priceGrid && priceGrid.parentElement && priceGrid.parentElement.id === 'mobileDetail'){
        detailPanel.appendChild(priceGrid);
      }
    }catch(e){}
    detailPlaceholder.classList.add('hidden');
    smoothShow(detailPanel);
    // 桌面端也进行强调：先移除旧的，再设置新的
    try{ if(window.MOBILE_CURRENT_TARGET && window.MOBILE_CURRENT_TARGET !== mountTarget){ window.MOBILE_CURRENT_TARGET.classList.remove('active-svc'); } }catch(e){}
    try{ if(mountTarget){ mountTarget.classList.add('active-svc'); } }catch(e){}
    window.MOBILE_CURRENT_TARGET = mountTarget || null;
  }
  svcTitle.textContent = svc.title;
  svcMeta.textContent = `${game.name} · ${svc.desc}`;
  // 兼容旧数据：若未提供联系方式字段则不显示
  try{
    const contactText = (svc.contact && (svc.contact.type || svc.contact.value))
      ? `${svc.contact.type || ''}${svc.contact.type ? ': ' : ''}${svc.contact.value || ''}`
      : '';
    contactVal.textContent = contactText;
  }catch(e){ contactVal.textContent = ''; }

  pricesEl.innerHTML = '';
  // 重置当前选择的单价
  selectedUnitPrice = 0;
  selectedLabel = '';
  (svc.priceOptions || []).forEach(p=>{
    const pc = document.createElement('div');
    pc.className = 'price-card';
    const discountText = (svc.discount && svc.discount.enabled)
      ? (svc.discount.type === 'second' ? '第二份开始打折' : (svc.discount.type === 'conditional' ? '满足条件时打折' : '越多越便宜'))
      : '';
    pc.innerHTML = `
      <div style="display:flex;justify-content:space-between;align-items:center">
        <div style="font-weight:600">${p.label}</div>
        ${discountText ? `<div style="color:#f87171;font-size:12px">${discountText}</div>` : ''}
      </div>
      <div style="margin-top:6px;font-size:18px;font-weight:700">¥${p.price}</div>
    `;
    pc.dataset.price = p.price;
    pc.dataset.label = p.label;
    pc.addEventListener('click',()=>{
      // 选择此单价，并数量+1
      selectedUnitPrice = Number(p.price) || 0;
      selectedLabel = p.label || '';
      pricesEl.querySelectorAll('.price-card').forEach(el=> el.classList.toggle('active', el===pc));
      unitPriceHint.textContent = `(单价 ¥${selectedUnitPrice})`;
      qtyInput.value = (Number(qtyInput.value)||0) + 1;
      updateTotal();
    });
    pricesEl.appendChild(pc);
  });

  // 默认选择第一个单价
  if(svc.priceOptions && svc.priceOptions.length){
    selectedUnitPrice = Number(svc.priceOptions[0].price)||0;
    selectedLabel = svc.priceOptions[0].label||'';
    const first = pricesEl.querySelector('.price-card');
    first && first.classList.add('active');
    unitPriceHint.textContent = `(单价 ¥${selectedUnitPrice})`;
  }else{
    unitPriceHint.textContent = '';
  }

  // 重置数量与总价
  if(qtyInput){ qtyInput.value = 0; }
  updateTotal();

  paysEl.innerHTML = '';
  (svc.paymentMethods||[]).filter(m=> m !== 'QQ钱包').forEach(m=>{
    const li = document.createElement('li');
    li.textContent = m;
    paysEl.appendChild(li);
  });

  // 控制支付切换按钮显示与默认二维码
  const hasWeChat = (svc.paymentMethods||[]).some(m=>/微/.test(m));
  const hasAlipay = (svc.paymentMethods||[]).some(m=>/支/.test(m));
  if(payToggle && qrPanel){
    const weBtn = payToggle.querySelector('[data-pay="wechat"]');
    const aliBtn = payToggle.querySelector('[data-pay="alipay"]');
    if(weBtn) weBtn.style.display = hasWeChat ? '' : 'none';
    if(aliBtn) aliBtn.style.display = hasAlipay ? '' : 'none';
    qrPanel.style.display = (hasWeChat || hasAlipay) ? '' : 'none';
    if(hasWeChat){ switchPay('wechat'); }
    else if(hasAlipay){ switchPay('alipay'); }
  }

  // 已取消邮件下单按钮
  // 注册点按反馈（为本次渲染产生的可点击元素添加缩放反馈）
  addPressFeedback(isMobile ? (mobileMount || detailPanel) : detailPanel);
}

// 更新总价
function updateTotal(){
  if(!totalPriceEl) return;
  const q = Math.max(0, Number(qtyInput && qtyInput.value || 0));
  const unit = (typeof selectedUnitPrice !== 'undefined' ? selectedUnitPrice : 0) || 0;
  const baseTotal = q * unit;
  let totalFloat = baseTotal;
  let discountAmount = 0;
  const dis = currentService && currentService.discount;
  const cfg = window.DISCOUNT_CONFIG || { more:{p2:0.08,p3:0.09,p4plus:0.10,cap:0.10}, second:{p:0.10,cap:0.10} };
  if(dis && dis.enabled){
    if(dis.type === 'more'){
      // 阶梯计算：第1件原价，第2件(1-p2)，第3件(1-p3)，第4及以上(1-p4plus)
      const p2 = Math.min(cfg.more.p2 || 0, cfg.more.cap || 1);
      const p3 = Math.min(cfg.more.p3 || 0, cfg.more.cap || 1);
      const p4 = Math.min(cfg.more.p4plus || 0, cfg.more.cap || 1);
      totalFloat = 0;
      for(let i=1;i<=q;i++){
        let rate = 1;
        if(i===2) rate = 1 - p2;
        else if(i===3) rate = 1 - p3;
        else if(i>=4) rate = 1 - p4;
        totalFloat += unit * rate;
      }
      discountAmount = Math.max(0, baseTotal - totalFloat);
    } else if(dis.type === 'second'){
      const p = Math.min(cfg.second.p || 0, cfg.second.cap || 1);
      totalFloat = q<=0 ? 0 : (unit * 1) + unit * Math.max(0, q-1) * (1 - p);
      discountAmount = Math.max(0, baseTotal - totalFloat);
    } else {
      totalFloat = baseTotal; // conditional 暂不实现
      discountAmount = 0;
    }
  }
  const total = Math.floor(totalFloat);
  if(discountAmount > 0){
    totalPriceEl.innerHTML = `¥${total} <span style="color:#f87171;font-size:12px">（已减¥${Math.floor(discountAmount)}）</span>`;
  } else {
    totalPriceEl.textContent = `¥${total}`;
  }
  // 单价提示：显示有效折扣百分比（基于加权）
  if(unitPriceHint){
    if(unit > 0){
      const effPercent = baseTotal>0 ? (discountAmount / baseTotal) : 0;
      if(effPercent > 0){
        unitPriceHint.textContent = `(单价 ¥${unit}，折扣 -${Math.round(effPercent*100)}%)`;
      } else {
        unitPriceHint.textContent = `(单价 ¥${unit})`;
      }
    } else {
      unitPriceHint.textContent = '';
    }
  }
}

// 折扣设置仅在“管理员.html”中显示；用户页不提供调整面板。

// 数量加减与输入
qtyPlus && qtyPlus.addEventListener('click',()=>{ qtyInput.value = (Number(qtyInput.value)||0)+1; updateTotal(); });
qtyMinus && qtyMinus.addEventListener('click',()=>{ qtyInput.value = Math.max(0,(Number(qtyInput.value)||0)-1); updateTotal(); });
qtyInput && qtyInput.addEventListener('input',()=>{ const v = Math.max(0, Math.floor(Number(qtyInput.value)||0)); qtyInput.value = v; updateTotal(); });

// 点按反馈逻辑：按下时缩小 30%，松开/离开时恢复
function registerPressable(el){
  if(!el) return;
  el.classList.add('pressable');
  if(el.dataset.pressable==='1') return; // 防止重复绑定
  el.dataset.pressable='1';
  const down = ()=> el.classList.add('pressed');
  const up = ()=> el.classList.remove('pressed');
  el.addEventListener('pointerdown', down);
  el.addEventListener('pointerup', up);
  el.addEventListener('pointerleave', up);
  el.addEventListener('pointercancel', up);
}
function addPressFeedback(scope=document){
  const selectors = ['#prices .price-card', '.pill', '.qty-btn', '.btn', '.service', '.game-card', '.add-category', '.back-to-top', '.more-btn', '.subset-header', '.subset .toggleIndicator'];
  const els = scope.querySelectorAll(selectors.join(','));
  els.forEach(registerPressable);
}

// 初次加载时也为现有按钮添加反馈
document.addEventListener('DOMContentLoaded', ()=> addPressFeedback(document));

// 仅手机端为二维码图片添加按压反馈；桌面端不添加缩放效果
function setupQrPressFeedback(){
  try{
    const isMobile600 = window.matchMedia && window.matchMedia('(max-width: 600px)').matches;
    if(!payQrImg) return;
    if(isMobile600){
      registerPressable(payQrImg);
    }else{
      payQrImg.classList.remove('pressed','pressable');
      try{ if(payQrImg.dataset) delete payQrImg.dataset.pressable; }catch(e){}
    }
  }catch(e){}
}
setupQrPressFeedback();
window.addEventListener('resize', setupQrPressFeedback);

/* 支付方式切换与二维码过渡 */
function switchPay(type){
  if(!payToggle || !payQrImg || !qrTitlePay) return;
  const label = type === 'wechat' ? '微信' : '支付宝';
  qrTitlePay.textContent = label;
  // 渐隐 → 切图 → 渐显
  payQrImg.classList.remove('fade-in');
  payQrImg.classList.add('fade-out');
  const baseName = type === 'wechat' ? '微信收款码' : '支付宝收款码';
  const nextSrcWebp = baseName + '.webp';
  const nextSrcPng = baseName + '.png';
  setTimeout(()=>{
    // 优先尝试 WebP，失败则回退到 PNG（保证兼容性与加载速度）
    payQrImg.onerror = function(){
      payQrImg.onerror = null;
      payQrImg.src = nextSrcPng;
    };
    payQrImg.src = nextSrcWebp;
    payQrImg.onload = ()=>{
      payQrImg.classList.remove('fade-out');
      payQrImg.classList.add('fade-in');
    };
  },150);
  // 按钮高亮
  payToggle.querySelectorAll('button').forEach(btn=>{
    btn.classList.toggle('active', btn.dataset.pay === type);
  });
  // 面板底色切换（支付宝为 #1677ff）
  if(qrPanel){
    qrPanel.classList.remove('alipay');
    if(type==='alipay'){
      qrPanel.classList.add('alipay');
    }
  }
}

payToggle && payToggle.addEventListener('click',(e)=>{
  const btn = e.target.closest('button');
  if(!btn) return;
  const pay = btn.dataset.pay;
  if(pay){ switchPay(pay); }
});

/* ------------------ 复制联系方式 ------------------ */
copyBtn.addEventListener('click',async ()=>{
  if(!currentService){alert('请先选一个服务');return;}
  const text = currentService.contact.value;
  try{
    await navigator.clipboard.writeText(text);
    copyBtn.textContent = '已复制';
    copyBtn.classList.add('copy-ok');
    setTimeout(()=>{copyBtn.textContent='复制联系方式'; copyBtn.classList.remove('copy-ok')},2000);
  }catch(e){
    prompt('请手动复制联系方式：', text);
  }
});

payGuide.addEventListener('click',()=>{
  alert('定金单尾款需提前找客服结清噢~');
});

clearBtn.addEventListener('click',()=>{ qEl.value=''; renderList(''); });
qEl.addEventListener('input',(e)=>renderList(e.target.value));

// 顶部文件保存/导入按钮事件
btnSaveFile && btnSaveFile.addEventListener('click', saveToFile);
btnLoadFile && btnLoadFile.addEventListener('click', loadFromFile);

/* 已移除管理员模态相关功能（公开站点不支持新增/编辑品类） */

// 已移除管理员模态与新增品类按钮（公开站点不支持新增/编辑）

/* ------------------ 手机端：返回顶部按钮（滚动后显示） ------------------ */
const backToTopBtn = document.getElementById('backToTopBtn');
function getScrollTop(){
  return document.scrollingElement ? document.scrollingElement.scrollTop : (window.pageYOffset || document.documentElement.scrollTop || 0);
}
// 自定义滚动动画：更平滑、更可控
function animateScrollToTop(duration=700, onDone){
  const start = getScrollTop();
  const startTime = performance.now();
  const easeOutCubic = t => 1 - Math.pow(1 - t, 3);
  function step(now){
    const elapsed = now - startTime;
    const progress = Math.min(elapsed / duration, 1);
    const eased = easeOutCubic(progress);
    const current = Math.round(start * (1 - eased));
    try{
      if(document.scrollingElement) document.scrollingElement.scrollTop = current; else window.scrollTo(0, current);
    }catch(e){ window.scrollTo(0, current); }
    if(progress < 1){
      requestAnimationFrame(step);
    } else {
      if(typeof onDone === 'function') onDone();
    }
  }
  requestAnimationFrame(step);
}
function updateTopBtnVisibility(){
  const isMobile = window.innerWidth <= 768;
  if(!isMobile){
    backToTopBtn.classList.remove('show');
    return;
  }
  const threshold = 300; // 下滑一定距离后显示
  if(getScrollTop() > threshold){
    backToTopBtn.classList.add('show');
  }else{
    backToTopBtn.classList.remove('show');
  }
}
window.addEventListener('scroll', updateTopBtnVisibility, { passive: true });
window.addEventListener('resize', updateTopBtnVisibility);
backToTopBtn.addEventListener('click', ()=>{
  // 滑动与收起同时进行；为防止高度骤降导致瞬间跳顶，先插入占位元素维持高度
  const currentTop = getScrollTop();
  let spacer = null;
  try{
    if(currentTop > 0){
      spacer = document.createElement('div');
      spacer.className = 'reset-spacer';
      spacer.style.height = currentTop + 'px';
      spacer.style.visibility = 'hidden';
      spacer.style.pointerEvents = 'none';
      document.body.appendChild(spacer);
    }
  }catch(e){}
  // 开始滚动动画（600ms），滚动结束后移除占位
  animateScrollToTop(600, ()=>{ try{ if(spacer) spacer.remove(); }catch(e){} });

  // 同时执行收起与重置（无论桌面还是手机）
  try{
    // 收起所有品类的服务列表（transform/opacity 动画版）
    document.querySelectorAll('.game .services').forEach(el=>{ el.classList.remove('closing'); el.classList.remove('open'); el.setAttribute('aria-hidden','true'); });
    document.querySelectorAll('.game .toggleIndicator').forEach(el=>el.textContent='+');
    document.querySelectorAll('.game-card').forEach(el=>el.classList.remove('active-cat'));
  }catch(e){}
  try{
    // 收起所有子集面板（transform/opacity 动画版）并重置加号
    document.querySelectorAll('.subset-services').forEach(el=>{ el.classList.remove('closing'); el.classList.remove('open'); el.setAttribute('aria-hidden','true'); });
    document.querySelectorAll('.subset .toggleIndicator').forEach(el=>{ el.textContent = '+'; });
    // 同时移除所有子集的强调态
    document.querySelectorAll('.subset').forEach(el=>el.classList.remove('active-subset'));
  }catch(e){}
  // 手机端额外：收起内嵌面板与详情
  const isMobile = window.innerWidth <= 768;
  if(isMobile){
    try{
      const mobileMount = document.getElementById('mobileDetail');
      if(mobileMount && !mobileMount.classList.contains('hidden')){
        smoothHide(mobileMount);
      }
    }catch(e){}
    try{
      const priceGridEl = document.querySelector('.price-grid');
      if(detailPanel && priceGridEl && priceGridEl.parentElement !== detailPanel){
        detailPanel.appendChild(priceGridEl);
      }
      smoothHide(detailPanel);
    }catch(e){}
    try{
      if(window.MOBILE_CURRENT_TARGET){
        window.MOBILE_CURRENT_TARGET.classList.remove('active-svc');
        window.MOBILE_CURRENT_TARGET = null;
      }
    }catch(e){}
  }
});
// 初始化一次（移动端才显示）
updateTopBtnVisibility();

/* ------------------ 主题切换（更换 CSS 变量并保存主题） ------------------ */
const themeButtons = document.querySelectorAll('[data-theme]');
themeButtons.forEach(btn=>{
  btn.addEventListener('click', ()=>{
    const t = btn.dataset.theme;
    applyTheme(t);
  });
});

function applyTheme(t){
  document.documentElement.setAttribute('data-theme', t);
  try{ localStorage.setItem('boost_theme_v1', t); }catch(e){}
  if(t==='black'){
    document.documentElement.style.setProperty('--bg','#121212');
    document.documentElement.style.setProperty('--card','#1e1e1e');
    document.documentElement.style.setProperty('--muted','#a1a1aa');
    document.documentElement.style.setProperty('--accent','#3b82f6');
    document.documentElement.style.setProperty('--border','#2a2a2a');
    document.body.style.color = '#e5e7eb';
  } else if(t==='white'){
    document.documentElement.style.setProperty('--bg','#f6f7fb');
    document.documentElement.style.setProperty('--card','#ffffff');
    document.documentElement.style.setProperty('--muted','#6b7280');
    document.documentElement.style.setProperty('--accent','#10b981');
    document.documentElement.style.setProperty('--border','#e6e9ef');
    document.body.style.color = '#0f172a';
  } else if(t==='pink'){
    document.documentElement.style.setProperty('--bg','#fff3f4');
    document.documentElement.style.setProperty('--card','#fff');
    document.documentElement.style.setProperty('--muted','#6b7280');
    document.documentElement.style.setProperty('--accent','#fb7185');
    document.documentElement.style.setProperty('--border','#fdecef');
    document.body.style.color = '#0f172a';
  } else if(t==='lime'){
    document.documentElement.style.setProperty('--bg','#f7ffed');
    document.documentElement.style.setProperty('--card','#ffffff');
    document.documentElement.style.setProperty('--muted','#526057');
    document.documentElement.style.setProperty('--accent','#84cc16');
    document.documentElement.style.setProperty('--border','#eef9e6');
    document.body.style.color = '#0f172a';
  } else if(t==='orange'){
    document.documentElement.style.setProperty('--bg','#fff7ed');
    document.documentElement.style.setProperty('--card','#ffffff');
    document.documentElement.style.setProperty('--muted','#6b4f2a');
    document.documentElement.style.setProperty('--accent','#fb923c');
    document.documentElement.style.setProperty('--border','#fff1e6');
    document.body.style.color = '#0f172a';
  }
}

// 恢复上次保存的主题；如无记录则默认白色
try{
  const savedTheme = localStorage.getItem('boost_theme_v1');
  applyTheme(savedTheme || 'white');
}catch(e){ applyTheme('white'); }

/* Eliya备注：展开/收起动画工具函数（0.1s，放在脚本内部，避免未定义错误） */
function smoothShow(el){
  if(!el) return;
  el.classList.remove('hidden');
  el.classList.add('smooth-toggle');
  el.style.maxHeight = '0px';
  el.style.opacity = '0';
  setTimeout(()=>{
    try{ el.style.maxHeight = el.scrollHeight + 'px'; el.style.opacity = '1'; }catch(e){}
  }, 0);
}
function smoothHide(el){
  if(!el) return;
  el.style.maxHeight = '0px';
  el.style.opacity = '0';
  setTimeout(()=>{
    el.classList.add('hidden');
    el.classList.remove('smooth-toggle');
    el.style.maxHeight = '';
    el.style.opacity = '';
  }, 110); // Eliya备注：略大于 0.1s，保证动画完成
}

/* ------------------ 初始渲染 ------------------ */
renderList();

// End of script
</script>
<!-- 自动从仓库中的 JSON 备份加载数据（仅影响默认数据，不改桌面样式） -->
<script src="data-autoload.js"></script>
<!-- 公开版只读模式：隐藏编辑/导入/保存/拖拽等控件，保留查看/复制/支付切换等 -->
<script src="viewer-mode.js"></script>

</body>
</html>
